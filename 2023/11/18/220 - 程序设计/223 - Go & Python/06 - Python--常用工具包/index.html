<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Hexo | Hexo</title><meta name="author" content="John Doe"><meta name="copyright" content="John Doe"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="1 Pandas 数据处理1.1 Pandas 数据结构 - SeriesPandas Series 类似表格中的一个列（column），类似于一维数组，可以保存任何数据类型。 Series 由索引（index）和列组成，函数如下： 1pandas.Series( data, index, dtype, name, copy)  参数说明：  data：一组数据(ndarray 类型)。 inde">
<meta property="og:type" content="article">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/2023/11/18/220%20-%20%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/223%20-%20Go%20&%20Python/06%20-%20Python--%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7%E5%8C%85/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="1 Pandas 数据处理1.1 Pandas 数据结构 - SeriesPandas Series 类似表格中的一个列（column），类似于一维数组，可以保存任何数据类型。 Series 由索引（index）和列组成，函数如下： 1pandas.Series( data, index, dtype, name, copy)  参数说明：  data：一组数据(ndarray 类型)。 inde">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png">
<meta property="article:published_time" content="2023-11-18T15:14:22.859Z">
<meta property="article:modified_time" content="2023-11-18T15:14:22.859Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2023/11/18/220%20-%20%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/223%20-%20Go%20&amp;%20Python/06%20-%20Python--%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7%E5%8C%85/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Hexo',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-11-18 15:14:22'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">13</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">4</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><hr class="custom-hr"/></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="Hexo"><span class="site-name">Hexo</span></a></span><div id="menus"><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Untitled</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2023-11-18T15:14:22.859Z" title="Created 2023-11-18 15:14:22">2023-11-18</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2023-11-18T15:14:22.859Z" title="Updated 2023-11-18 15:14:22">2023-11-18</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="1-Pandas-数据处理"><a href="#1-Pandas-数据处理" class="headerlink" title="1 Pandas 数据处理"></a>1 Pandas 数据处理</h1><h2 id="1-1-Pandas-数据结构-Series"><a href="#1-1-Pandas-数据结构-Series" class="headerlink" title="1.1 Pandas 数据结构 - Series"></a>1.1 Pandas 数据结构 - Series</h2><p>Pandas Series 类似表格中的一个列（column），类似于一维数组，可以保存任何数据类型。</p>
<p>Series 由索引（index）和列组成，函数如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pandas.Series( data, index, dtype, name, copy)</span><br></pre></td></tr></table></figure>

<p>参数说明：</p>
<ul>
<li><strong>data</strong>：一组数据(ndarray 类型)。</li>
<li><strong>index</strong>：数据索引标签，如果不指定，默认从 0 开始。</li>
<li><strong>dtype</strong>：数据类型，默认会自己判断。</li>
<li><strong>name</strong>：设置名称。</li>
<li><strong>copy</strong>：拷贝数据，默认为 False。</li>
</ul>
<p><strong>示例：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 从列表创建Series  </span></span><br><span class="line">pd.Series([<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>])  </span><br><span class="line"><span class="comment"># 0    a  </span></span><br><span class="line"><span class="comment"># 1    b  </span></span><br><span class="line"><span class="comment"># 2    c  </span></span><br><span class="line"><span class="comment"># dtype: object  </span></span><br><span class="line"><span class="comment"># 自动创建索引  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 通过字典创建带索引的Series  </span></span><br><span class="line">s1 = pd.Series(&#123;<span class="string">&#x27;a&#x27;</span>:<span class="number">11</span>, <span class="string">&#x27;b&#x27;</span>:<span class="number">22</span>, <span class="string">&#x27;c&#x27;</span>:<span class="number">33</span>&#125;)  </span><br><span class="line"><span class="comment"># a    11  </span></span><br><span class="line"><span class="comment"># b    22  </span></span><br><span class="line"><span class="comment"># c    33  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 通过关键字创建带索引的Series  </span></span><br><span class="line">s2 = pd.Series([<span class="number">11</span>, <span class="number">22</span>, <span class="number">33</span>], index = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>])  </span><br><span class="line"><span class="built_in">print</span>(s1)  </span><br><span class="line"><span class="comment"># a    11  </span></span><br><span class="line"><span class="comment"># b    22  </span></span><br><span class="line"><span class="comment"># c    33  </span></span><br><span class="line"><span class="built_in">print</span>(s2[<span class="string">&#x27;a&#x27;</span>]) <span class="comment"># 根据索引取值 11# 获取全部索引  </span></span><br><span class="line"><span class="built_in">print</span>(s2.index) <span class="comment"># Index([&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;], dtype=&#x27;object&#x27;)  </span></span><br><span class="line"><span class="comment"># 获取全部值  </span></span><br><span class="line"><span class="built_in">print</span>(s2.values) <span class="comment"># [11 22 33]  </span></span><br><span class="line"><span class="comment"># 类型  </span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(s1.values))    <span class="comment"># &lt;class &#x27;numpy.ndarray&#x27;&gt;  </span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(np.array([<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>])))  <span class="comment"># Pandas的数据结构是基于numpy  </span></span><br><span class="line"><span class="comment"># 转换为列表  </span></span><br><span class="line">s2.values.tolist() <span class="comment"># [11, 22, 33]</span></span><br></pre></td></tr></table></figure>

<p>使用map函数，处理Series中的值，生成新的Series：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 取出email  </span></span><br><span class="line">emails = pd.Series([<span class="string">&#x27;abc at amazom.com&#x27;</span>, <span class="string">&#x27;admin1@163.com&#x27;</span>, <span class="string">&#x27;mat@m.at&#x27;</span>, <span class="string">&#x27;ab@abc.com&#x27;</span>])  </span><br><span class="line"><span class="keyword">import</span> re  </span><br><span class="line">pattern =<span class="string">&#x27;[A-Za-z0-9._]+@[A-Za-z0-9.-]+\\.[A-Za-z]&#123;2,5&#125;&#x27;</span>  </span><br><span class="line">mask = emails.<span class="built_in">map</span>(<span class="keyword">lambda</span> x: <span class="built_in">bool</span>(re.<span class="keyword">match</span>(pattern, x))) <span class="comment"># 遍历emails中的values  </span></span><br><span class="line"><span class="built_in">print</span>(mask)  </span><br><span class="line"><span class="comment"># 0    False  </span></span><br><span class="line"><span class="comment"># 1     True  </span></span><br><span class="line"><span class="comment"># 2     True  </span></span><br><span class="line"><span class="comment"># 3     True  </span></span><br><span class="line"><span class="built_in">print</span>(emails[mask])  </span><br><span class="line"><span class="comment"># 1    admin1@163.com  </span></span><br><span class="line"><span class="comment"># 2          mat@m.at  </span></span><br><span class="line"><span class="comment"># 3        ab@abc.com</span></span><br></pre></td></tr></table></figure>

<p>Pandas通过index可以提升查询性能：</p>
<ol>
<li>如果index唯一，pandas会使用哈希表优化，查询性能为O(1)</li>
<li>如果index有序不唯一，pandas会使用二分查找算法，查询性能为O(logN)</li>
<li>如果index完全随机，每次查询都要扫全表，查询性能为O(N)</li>
</ol>
<h2 id="1-2-Pandas-数据结构-DataFrame"><a href="#1-2-Pandas-数据结构-DataFrame" class="headerlink" title="1.2 Pandas 数据结构 - DataFrame"></a>1.2 Pandas 数据结构 - DataFrame</h2><p>DataFrame 是一个表格型的数据结构，它含有一组有序的列，每列可以是不同的值类型（数值、字符串、布尔型值）。DataFrame 既有行索引也有列索引，它可以被看做由 Series 组成的字典（共同用一个索引）。<br><img src="https://raw.githubusercontent.com/BaihlUp/Figurebed/master/2023/20231110102650.png"><br><img src="https://raw.githubusercontent.com/BaihlUp/Figurebed/master/2023/20231110102712.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pandas.DataFrame( data, index, columns, dtype, copy)</span><br></pre></td></tr></table></figure>
<p>参数说明：</p>
<ul>
<li><strong>data</strong>：一组数据(ndarray、series, map, lists, dict 等类型)。</li>
<li><strong>index</strong>：索引值，或者可以称为行索引。</li>
<li><strong>columns</strong>：列索引，默认为 RangeIndex (0, 1, 2, …, n) 。</li>
<li><strong>dtype</strong>：数据类型。</li>
<li><strong>copy</strong>：拷贝数据，默认为 False。</li>
</ul>
<p><strong>示例：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 列表创建dataframe，与Series不同的是有了列索引</span></span><br><span class="line">df1 = pd.DataFrame([<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>])  </span><br><span class="line"><span class="comment">#    0  </span></span><br><span class="line"><span class="comment"># 0  a  </span></span><br><span class="line"><span class="comment"># 1  b  </span></span><br><span class="line"><span class="comment"># 2  c  </span></span><br><span class="line"><span class="comment"># 3  d</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 嵌套列表创建dataframe  </span></span><br><span class="line">df2 = pd.DataFrame([  </span><br><span class="line">                     [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>],   </span><br><span class="line">                     [<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>]  </span><br><span class="line">                    ])  </span><br><span class="line"><span class="comment"># 自定义列索引  </span></span><br><span class="line">df2.columns= [<span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;two&#x27;</span>]  </span><br><span class="line"><span class="comment"># 自定义行索引  </span></span><br><span class="line">df2.index = [<span class="string">&#x27;first&#x27;</span>, <span class="string">&#x27;second&#x27;</span>]  </span><br><span class="line"><span class="built_in">print</span>(df2)  </span><br><span class="line"><span class="comment">#        one two  </span></span><br><span class="line"><span class="comment"># first    a   b  </span></span><br><span class="line"><span class="comment"># second   c   d  </span></span><br><span class="line"><span class="comment"># 可以在创建时直接指定 DataFrame([...] , columns=&#x27;...&#x27;, index=&#x27;...&#x27; )# 查看索引  </span></span><br><span class="line"><span class="built_in">print</span>(df2.columns) <span class="comment"># Index([&#x27;one&#x27;, &#x27;two&#x27;], dtype=&#x27;object&#x27;)  </span></span><br><span class="line"><span class="built_in">print</span>(df2.index) <span class="comment"># Index([&#x27;first&#x27;, &#x27;second&#x27;], dtype=&#x27;object&#x27;)  </span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(df2.values)) <span class="comment"># &lt;class &#x27;numpy.ndarray&#x27;&gt;  </span></span><br><span class="line"><span class="built_in">print</span>(df2.values.tolist()) <span class="comment"># [[&#x27;a&#x27;, &#x27;b&#x27;], [&#x27;c&#x27;, &#x27;d&#x27;]]</span></span><br></pre></td></tr></table></figure>


<h2 id="1-3-数据导入"><a href="#1-3-数据导入" class="headerlink" title="1.3 数据导入"></a>1.3 数据导入</h2><p>Pandas支持大量格式的导入，使用的是<code>read_*()</code> 的形式，如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd  </span><br><span class="line"><span class="comment"># pip install xlrd # excel文件需要  </span></span><br><span class="line"><span class="comment"># 导入excel文件  </span></span><br><span class="line">excel1 = pd.read_excel(<span class="string">r&#x27;1.xlsx&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(excel1)  </span><br><span class="line"><span class="comment"># 0     1    4.0     5     7  </span></span><br><span class="line"><span class="comment"># 1    33    NaN    55    66  </span></span><br><span class="line"><span class="comment"># 2   111  222.0   333   444  </span></span><br><span class="line"><span class="comment"># 显示前几行  </span></span><br><span class="line"><span class="built_in">print</span>(excel1.head(<span class="number">2</span>))  </span><br><span class="line"><span class="comment">#    num1  num2  num3  num4  </span></span><br><span class="line"><span class="comment"># 0     1   4.0     5     7  </span></span><br><span class="line"><span class="comment"># 1    33   NaN    55    66  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 行列数量  </span></span><br><span class="line"><span class="built_in">print</span>(excel1.shape) <span class="comment"># (3, 4)  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 详细信息  </span></span><br><span class="line"><span class="comment"># excel1.info()  </span></span><br><span class="line"><span class="built_in">print</span>(excel1.describe())  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 指定导入哪个Sheet  </span></span><br><span class="line">pd.read_excel(<span class="string">r&#x27;1.xlsx&#x27;</span>,sheet_name = <span class="number">0</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 支持其他常见类型  </span></span><br><span class="line">pd.read_csv(<span class="string">r&#x27;book_utf8.csv&#x27;</span>,sep=<span class="string">&#x27;,&#x27;</span>, nrows=<span class="number">10</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)  </span><br><span class="line">  </span><br><span class="line">pd.read_table( <span class="string">r&#x27;file.txt&#x27;</span> , sep = <span class="string">&#x27; &#x27;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> pymysql  </span><br><span class="line">sql  =  <span class="string">&#x27;SELECT *  FROM mytable&#x27;</span>  </span><br><span class="line">conn = pymysql.connect(<span class="string">&#x27;ip&#x27;</span>,<span class="string">&#x27;name&#x27;</span>,<span class="string">&#x27;pass&#x27;</span>,<span class="string">&#x27;dbname&#x27;</span>,<span class="string">&#x27;charset=utf8&#x27;</span>)  </span><br><span class="line"><span class="comment"># 从数据库中读取  </span></span><br><span class="line">df = pd.read_sql(sql,conn)</span><br></pre></td></tr></table></figure>

<ol>
<li><code>pd.read_excel(r&#39;1.xlsx&#39;,sheet_name = 0)</code> 导入excel，并且指定sheet</li>
<li><code>pd.read_sql(sql,conn)</code> 导入数据库</li>
</ol>
<h2 id="1-4-数据预处理"><a href="#1-4-数据预处理" class="headerlink" title="1.4 数据预处理"></a>1.4 数据预处理</h2><ol>
<li><p><strong>处理缺失值</strong></p>
<ul>
<li><code>isnull()</code>: 返回布尔值DataFrame，指示每个元素是否为缺失值。示例: <code>df.isnull()</code></li>
<li><code>fillna(value)</code>: 用指定值填充缺失值。示例: <code>df.fillna(0)</code></li>
<li><code>dropna()</code>: 删除包含缺失值的行或列。示例: <code>df.dropna()</code></li>
</ul>
</li>
<li><p><strong>处理重复值</strong></p>
<ul>
<li><code>duplicated()</code>: 返回布尔Series，指示是否为重复行。示例: <code>df.duplicated()</code></li>
<li><code>drop_duplicates()</code>: 删除DataFrame中的重复行。示例: <code>df.drop_duplicates()</code></li>
</ul>
</li>
<li><p><strong>处理异常值</strong></p>
<ul>
<li>标识或替换超出范围的值为缺失值:<ul>
<li><code>df[(df &lt; low) | (df &gt; high)] = np.nan</code></li>
<li><code>df.replace(value_to_replace, new_value)</code></li>
</ul>
</li>
</ul>
</li>
</ol>
<p><strong>示例：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd  </span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 空值的定义使用了 numpy的nan，也可以使用python的None  </span></span><br><span class="line">x = pd.Series([ <span class="number">1</span>, <span class="number">2</span>, np.nan, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="literal">None</span>, <span class="number">8</span>])  </span><br><span class="line"><span class="comment"># 0    1.0  </span></span><br><span class="line"><span class="comment"># 1    2.0  </span></span><br><span class="line"><span class="comment"># 2    NaN  </span></span><br><span class="line"><span class="comment"># 3    3.0  </span></span><br><span class="line"><span class="comment"># 4    4.0  </span></span><br><span class="line"><span class="comment"># 5    5.0  </span></span><br><span class="line"><span class="comment"># 6    6.0  </span></span><br><span class="line"><span class="comment"># 7    NaN  </span></span><br><span class="line"><span class="comment"># 8    8.0  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment">#检验序列中是否存在缺失值  </span></span><br><span class="line"><span class="built_in">print</span>(x.hasnans) <span class="comment"># True  </span></span><br><span class="line"><span class="built_in">print</span>(x.isnull())  </span><br><span class="line"><span class="comment"># 0    False  </span></span><br><span class="line"><span class="comment"># 1    False  </span></span><br><span class="line"><span class="comment"># 2     True  </span></span><br><span class="line"><span class="comment"># 3    False  </span></span><br><span class="line"><span class="comment"># 4    False  </span></span><br><span class="line"><span class="comment"># 5    False  </span></span><br><span class="line"><span class="comment"># 6    False  </span></span><br><span class="line"><span class="comment"># 7     True  </span></span><br><span class="line"><span class="comment"># 8    False  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 将缺失值填充为平均值  </span></span><br><span class="line">x.fillna(value = x.mean())  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 前向填充缺失值  </span></span><br><span class="line">df3=pd.DataFrame(&#123;<span class="string">&quot;A&quot;</span>:[<span class="number">5</span>,<span class="number">3</span>,<span class="literal">None</span>,<span class="number">4</span>],   </span><br><span class="line">                 <span class="string">&quot;B&quot;</span>:[<span class="literal">None</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">3</span>],   </span><br><span class="line">                 <span class="string">&quot;C&quot;</span>:[<span class="number">4</span>,<span class="number">3</span>,<span class="number">8</span>,<span class="number">5</span>],   </span><br><span class="line">                 <span class="string">&quot;D&quot;</span>:[<span class="number">5</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="literal">None</span>]&#125;)   </span><br><span class="line">                   </span><br><span class="line">df3.isnull().<span class="built_in">sum</span>() <span class="comment"># 查看缺失值汇总  </span></span><br><span class="line">df3.ffill() <span class="comment"># 用上一行填充  </span></span><br><span class="line">df3.ffill(axis=<span class="number">1</span>)  <span class="comment"># 用前一列填充  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 缺失值删除  </span></span><br><span class="line">df3.info()  </span><br><span class="line">df3.dropna()  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 填充缺失值  </span></span><br><span class="line">df3.fillna(<span class="string">&#x27;无&#x27;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 删除DataFrame中的重复行  </span></span><br><span class="line">df3.drop_duplicates()</span><br></pre></td></tr></table></figure>

<p><strong>DataFrame的数据调整：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd  </span><br><span class="line"><span class="comment"># 行列调整  </span></span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">&quot;A&quot;</span>:[<span class="number">5</span>,<span class="number">3</span>,<span class="literal">None</span>,<span class="number">4</span>],   </span><br><span class="line">                 <span class="string">&quot;B&quot;</span>:[<span class="literal">None</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">3</span>],   </span><br><span class="line">                 <span class="string">&quot;C&quot;</span>:[<span class="number">4</span>,<span class="number">3</span>,<span class="number">8</span>,<span class="number">5</span>],   </span><br><span class="line">                 <span class="string">&quot;D&quot;</span>:[<span class="number">5</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="literal">None</span>]&#125;)   </span><br><span class="line"><span class="comment"># 列的选择,多个列要用列表  </span></span><br><span class="line"><span class="built_in">print</span>(df[ [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;C&#x27;</span>] ])  </span><br><span class="line"><span class="comment">#      A  C  </span></span><br><span class="line"><span class="comment"># 0  5.0  4  </span></span><br><span class="line"><span class="comment"># 1  3.0  3  </span></span><br><span class="line"><span class="comment"># 2  NaN  8  </span></span><br><span class="line"><span class="comment"># 3  4.0  5  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 某几列  </span></span><br><span class="line"><span class="built_in">print</span>(df.iloc[:, [<span class="number">0</span>,<span class="number">2</span>]]) <span class="comment"># :表示所有行，获得第1和第3列  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 行选择  </span></span><br><span class="line"><span class="built_in">print</span>(df.loc[ [<span class="number">0</span>, <span class="number">2</span>] ]) <span class="comment"># 选择第1行和第3行  </span></span><br><span class="line"><span class="built_in">print</span>(df.loc[ <span class="number">0</span>:<span class="number">2</span>    ]) <span class="comment"># 选择第1行到第3行  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 比较，输出 A 列值小于5，且C列值小于4的行  </span></span><br><span class="line"><span class="built_in">print</span>(df[ ( df[<span class="string">&#x27;A&#x27;</span>]&lt;<span class="number">5</span> ) &amp; ( df[<span class="string">&#x27;C&#x27;</span>]&lt;<span class="number">4</span> )   ])</span><br><span class="line"><span class="comment"># 行列互换  </span></span><br><span class="line"><span class="built_in">print</span>(df.T)</span><br></pre></td></tr></table></figure>

<h2 id="1-6-计算操作"><a href="#1-6-计算操作" class="headerlink" title="1.6 计算操作"></a>1.6 计算操作</h2><h3 id="1-6-1-基本操作"><a href="#1-6-1-基本操作" class="headerlink" title="1.6.1 基本操作"></a>1.6.1 基本操作</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd  </span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">&quot;A&quot;</span>:[<span class="number">5</span>,<span class="number">3</span>,<span class="literal">None</span>,<span class="number">4</span>],   </span><br><span class="line">                 <span class="string">&quot;B&quot;</span>:[<span class="literal">None</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">3</span>],   </span><br><span class="line">                 <span class="string">&quot;C&quot;</span>:[<span class="number">4</span>,<span class="number">3</span>,<span class="number">8</span>,<span class="number">5</span>],   </span><br><span class="line">                 <span class="string">&quot;D&quot;</span>:[<span class="number">5</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="literal">None</span>]&#125;)  </span><br><span class="line"><span class="comment"># 算数运算  </span></span><br><span class="line"><span class="comment"># 两列之间的加减乘除  </span></span><br><span class="line"><span class="built_in">print</span>(df[<span class="string">&#x27;A&#x27;</span>] + df[<span class="string">&#x27;C&#x27;</span>])  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 任意一列加/减一个常数值，这一列中的所有值都加/减这个常数值  </span></span><br><span class="line"><span class="built_in">print</span>(df[<span class="string">&#x27;A&#x27;</span>] + <span class="number">5</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 比较运算  </span></span><br><span class="line"><span class="built_in">print</span>(df[<span class="string">&#x27;A&#x27;</span>] &gt; df [<span class="string">&#x27;C&#x27;</span>])  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># count非空值计数  </span></span><br><span class="line"><span class="built_in">print</span>(df.count())  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 非空值每列求和  </span></span><br><span class="line">df.<span class="built_in">sum</span>()  </span><br><span class="line">df[<span class="string">&#x27;A&#x27;</span>].<span class="built_in">sum</span>()  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># mean求均值  </span></span><br><span class="line"><span class="comment"># max求最大值  </span></span><br><span class="line"><span class="comment"># min求最小值  </span></span><br><span class="line"><span class="comment"># median求中位数  # mode求众数  </span></span><br><span class="line"><span class="comment"># var求方差  </span></span><br><span class="line"><span class="comment"># std求标准差</span></span><br></pre></td></tr></table></figure>

<h3 id="1-6-2-聚合计算"><a href="#1-6-2-聚合计算" class="headerlink" title="1.6.2 聚合计算"></a>1.6.2 聚合计算</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd  </span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 聚合  </span></span><br><span class="line">sales = [&#123;<span class="string">&#x27;account&#x27;</span>: <span class="string">&#x27;Jones LLC&#x27;</span>,<span class="string">&#x27;type&#x27;</span>:<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;Jan&#x27;</span>: <span class="number">150</span>, <span class="string">&#x27;Feb&#x27;</span>: <span class="number">200</span>, <span class="string">&#x27;Mar&#x27;</span>: <span class="number">140</span>&#125;,  </span><br><span class="line">         &#123;<span class="string">&#x27;account&#x27;</span>: <span class="string">&#x27;Alpha Co&#x27;</span>,<span class="string">&#x27;type&#x27;</span>:<span class="string">&#x27;b&#x27;</span>,  <span class="string">&#x27;Jan&#x27;</span>: <span class="number">200</span>, <span class="string">&#x27;Feb&#x27;</span>: <span class="number">210</span>, <span class="string">&#x27;Mar&#x27;</span>: <span class="number">215</span>&#125;,  </span><br><span class="line">         &#123;<span class="string">&#x27;account&#x27;</span>: <span class="string">&#x27;Blue Inc&#x27;</span>,<span class="string">&#x27;type&#x27;</span>:<span class="string">&#x27;a&#x27;</span>,  <span class="string">&#x27;Jan&#x27;</span>: <span class="number">50</span>,  <span class="string">&#x27;Feb&#x27;</span>: <span class="number">90</span>,  <span class="string">&#x27;Mar&#x27;</span>: <span class="number">95</span> &#125;]  </span><br><span class="line">  </span><br><span class="line">df2 = pd.DataFrame(sales)  </span><br><span class="line"><span class="built_in">print</span>(df2.groupby(<span class="string">&#x27;type&#x27;</span>).groups)  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">for</span> a, b <span class="keyword">in</span> df2.groupby(<span class="string">&#x27;type&#x27;</span>):  </span><br><span class="line">    <span class="built_in">print</span>(a)  </span><br><span class="line">    <span class="built_in">print</span>(b)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 聚合后再计算  </span></span><br><span class="line">df2.groupby(<span class="string">&#x27;type&#x27;</span>).count()  </span><br><span class="line"><span class="comment"># df2.groupby(&#x27;Jan&#x27;).sum()  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 各类型产品的销售数量和销售总额  </span></span><br><span class="line">df2.groupby(<span class="string">&#x27;type&#x27;</span>).aggregate( &#123;<span class="string">&#x27;type&#x27;</span>:<span class="string">&#x27;count&#x27;</span> , <span class="string">&#x27;Feb&#x27;</span>:<span class="string">&#x27;sum&#x27;</span> &#125;)  </span><br><span class="line">  </span><br><span class="line">group=[<span class="string">&#x27;x&#x27;</span>,<span class="string">&#x27;y&#x27;</span>,<span class="string">&#x27;z&#x27;</span>]  </span><br><span class="line">data=pd.DataFrame(&#123;  </span><br><span class="line">    <span class="string">&quot;group&quot;</span>:[group[x] <span class="keyword">for</span> x <span class="keyword">in</span> np.random.randint(<span class="number">0</span>,<span class="built_in">len</span>(group),<span class="number">10</span>)] ,  </span><br><span class="line">    <span class="string">&quot;salary&quot;</span>:np.random.randint(<span class="number">5</span>,<span class="number">50</span>,<span class="number">10</span>),  </span><br><span class="line">    <span class="string">&quot;age&quot;</span>:np.random.randint(<span class="number">15</span>,<span class="number">50</span>,<span class="number">10</span>)  </span><br><span class="line">    &#125;)  </span><br><span class="line"><span class="comment">#   group  salary  age  </span></span><br><span class="line"><span class="comment"># 0     y      35   39  </span></span><br><span class="line"><span class="comment"># 1     z      20   28  </span></span><br><span class="line"><span class="comment"># 2     z       5   42  </span></span><br><span class="line"><span class="comment"># 3     y      28   34  </span></span><br><span class="line"><span class="comment"># 4     y      37   47  </span></span><br><span class="line"><span class="comment"># 5     y      24   48  </span></span><br><span class="line"><span class="comment"># 6     x      45   32  </span></span><br><span class="line"><span class="comment"># 7     x      47   19  </span></span><br><span class="line"><span class="comment"># 8     z      30   18  </span></span><br><span class="line"><span class="comment"># 9     y      11   31  </span></span><br><span class="line">  </span><br><span class="line">data.groupby(<span class="string">&#x27;group&#x27;</span>).agg(<span class="string">&#x27;mean&#x27;</span>) <span class="comment"># 根据group进行聚合后在求和  </span></span><br><span class="line">data.groupby(<span class="string">&#x27;group&#x27;</span>).mean().to_dict() <span class="comment"># &#123;&#x27;salary&#x27;: &#123;&#x27;x&#x27;: 46.0, &#x27;y&#x27;: 27.0, &#x27;z&#x27;: 18.333333333333332&#125;, &#x27;age&#x27;: &#123;&#x27;x&#x27;: 25.5, &#x27;y&#x27;: 39.8, &#x27;z&#x27;: 29.333333333333332&#125;&#125;  </span></span><br><span class="line">data.groupby(<span class="string">&#x27;group&#x27;</span>).transform(<span class="string">&#x27;mean&#x27;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 数据透视表  </span></span><br><span class="line">pd.pivot_table(data,   </span><br><span class="line">               values=<span class="string">&#x27;salary&#x27;</span>,   </span><br><span class="line">               columns=<span class="string">&#x27;group&#x27;</span>,   </span><br><span class="line">               index=<span class="string">&#x27;age&#x27;</span>,   </span><br><span class="line">               aggfunc=<span class="string">&#x27;count&#x27;</span>,   </span><br><span class="line">               margins=<span class="literal">True</span>    </span><br><span class="line">).reset_index()</span><br></pre></td></tr></table></figure>


<h3 id="1-6-3-多表组合"><a href="#1-6-3-多表组合" class="headerlink" title="1.6.3 多表组合"></a>1.6.3 多表组合</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd  </span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np  </span><br><span class="line">  </span><br><span class="line">group = [<span class="string">&#x27;x&#x27;</span>,<span class="string">&#x27;y&#x27;</span>,<span class="string">&#x27;z&#x27;</span>]  </span><br><span class="line">data1 = pd.DataFrame(&#123;  </span><br><span class="line">    <span class="string">&quot;group&quot;</span>:[group[x] <span class="keyword">for</span> x <span class="keyword">in</span> np.random.randint(<span class="number">0</span>,<span class="built_in">len</span>(group),<span class="number">10</span>)] ,  </span><br><span class="line">    <span class="string">&quot;age&quot;</span>:np.random.randint(<span class="number">15</span>,<span class="number">50</span>,<span class="number">10</span>)  </span><br><span class="line">    &#125;)  </span><br><span class="line">  </span><br><span class="line">data2 = pd.DataFrame(&#123;  </span><br><span class="line">    <span class="string">&quot;group&quot;</span>:[group[x] <span class="keyword">for</span> x <span class="keyword">in</span> np.random.randint(<span class="number">0</span>,<span class="built_in">len</span>(group),<span class="number">10</span>)] ,  </span><br><span class="line">    <span class="string">&quot;salary&quot;</span>:np.random.randint(<span class="number">5</span>,<span class="number">50</span>,<span class="number">10</span>),  </span><br><span class="line">    &#125;)  </span><br><span class="line">  </span><br><span class="line">data3 = pd.DataFrame(&#123;  </span><br><span class="line">    <span class="string">&quot;group&quot;</span>:[group[x] <span class="keyword">for</span> x <span class="keyword">in</span> np.random.randint(<span class="number">0</span>,<span class="built_in">len</span>(group),<span class="number">10</span>)] ,  </span><br><span class="line">    <span class="string">&quot;age&quot;</span>:np.random.randint(<span class="number">15</span>,<span class="number">50</span>,<span class="number">10</span>),  </span><br><span class="line">    <span class="string">&quot;salary&quot;</span>:np.random.randint(<span class="number">5</span>,<span class="number">50</span>,<span class="number">10</span>),  </span><br><span class="line">    &#125;)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 一对一  </span></span><br><span class="line">pd.merge(data1, data2)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 多对一  </span></span><br><span class="line">pd.merge(data3, data2, on=<span class="string">&#x27;group&#x27;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 多对多  </span></span><br><span class="line">pd.merge(data3, data2)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 连接键类型，解决没有公共列问题  </span></span><br><span class="line">pd.merge(data3, data2, left_on= <span class="string">&#x27;age&#x27;</span>, right_on=<span class="string">&#x27;salary&#x27;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 连接方式  </span></span><br><span class="line"><span class="comment"># 内连接，不指明连接方式，默认都是内连接  </span></span><br><span class="line">pd.merge(data3, data2, on= <span class="string">&#x27;group&#x27;</span>, how=<span class="string">&#x27;inner&#x27;</span>)  </span><br><span class="line"><span class="comment"># 左连接 left# 右连接 right# 外连接 outer  </span></span><br><span class="line"><span class="comment"># 纵向拼接  </span></span><br><span class="line">pd.concat([data1, data2])</span><br></pre></td></tr></table></figure>

<h3 id="1-6-4-输出和绘图"><a href="#1-6-4-输出和绘图" class="headerlink" title="1.6.4 输出和绘图"></a>1.6.4 输出和绘图</h3><ul>
<li><strong>输出</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导出为.xlsx文件  </span></span><br><span class="line">df.to_excel( excel_writer = <span class="string">r&#x27;file.xlsx&#x27;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 设置Sheet名称  </span></span><br><span class="line">df.to_excel( excel_writer = <span class="string">r&#x27;file.xlsx&#x27;</span>, sheet_name = <span class="string">&#x27;sheet1&#x27;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 设置索引,设置参数index=False就可以在导出时把这种索引去掉  </span></span><br><span class="line">df.to_excel( excel_writer = <span class="string">r&#x27;file.xlsx&#x27;</span>, sheet_name = <span class="string">&#x27;sheet1&#x27;</span>, index = <span class="literal">False</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 设置要导出的列  </span></span><br><span class="line">df.to_excel( excel_writer = <span class="string">r&#x27;file.xlsx&#x27;</span>, sheet_name = <span class="string">&#x27;sheet1&#x27;</span>,   </span><br><span class="line">             index = <span class="literal">False</span>, columns = [<span class="string">&#x27;col1&#x27;</span>,<span class="string">&#x27;col2&#x27;</span>])  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 设置编码格式  </span></span><br><span class="line">enconding = <span class="string">&#x27;utf-8&#x27;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 缺失值处理  </span></span><br><span class="line">na_rep = <span class="number">0</span> <span class="comment"># 缺失值填充为0  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 无穷值处理  </span></span><br><span class="line">inf_rep = <span class="number">0</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 导出为.csv文件  </span></span><br><span class="line">to_csv()  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 性能  </span></span><br><span class="line">df.to_pickle(<span class="string">&#x27;xx.pkl&#x27;</span>)   </span><br><span class="line">  </span><br><span class="line">agg(<span class="built_in">sum</span>) <span class="comment"># 快  </span></span><br><span class="line">agg(<span class="keyword">lambda</span> x: x.<span class="built_in">sum</span>()) <span class="comment"># 慢</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>绘图</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd  </span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np  </span><br><span class="line">  </span><br><span class="line">dates = pd.date_range(<span class="string">&#x27;20200101&#x27;</span>, periods=<span class="number">12</span>)  </span><br><span class="line">df = pd.DataFrame(np.random.randn(<span class="number">12</span>,<span class="number">4</span>), index=dates, columns=<span class="built_in">list</span>(<span class="string">&#x27;ABCD&#x27;</span>))  </span><br><span class="line">df  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#                    A         B         C         D  </span></span><br><span class="line"><span class="comment"># 2020-01-01  0.046485 -0.556209  1.062881 -1.174129  </span></span><br><span class="line"><span class="comment"># 2020-01-02  1.066051 -0.343081  1.054913  1.601051  </span></span><br><span class="line"><span class="comment"># 2020-01-03  0.191064 -0.386905  0.516403  0.259818  </span></span><br><span class="line"><span class="comment"># 2020-01-04 -0.168462 -1.488041 -0.457658  0.913574  </span></span><br><span class="line"><span class="comment"># 2020-01-05 -0.502614  1.235633 -0.578284 -0.362737  </span></span><br><span class="line"><span class="comment"># 2020-01-06 -0.193310  0.652285 -0.346359  0.347364  </span></span><br><span class="line"><span class="comment"># 2020-01-07  2.308562 -0.679108  0.856449  0.490840  </span></span><br><span class="line"><span class="comment"># 2020-01-08  0.871489  0.338133 -0.163669  0.300147  </span></span><br><span class="line"><span class="comment"># 2020-01-09 -1.245250  0.667357 -1.287782  1.494880  </span></span><br><span class="line"><span class="comment"># 2020-01-10  0.387925 -1.058867 -0.397298  0.514921  </span></span><br><span class="line"><span class="comment"># 2020-01-11 -0.440884  0.904307  1.338720  0.612919  </span></span><br><span class="line"><span class="comment"># 2020-01-12 -0.864941 -0.358934 -0.203868 -1.191186  </span></span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt  </span><br><span class="line">plt.plot(df.index, df[<span class="string">&#x27;A&#x27;</span>], )  </span><br><span class="line">plt.show()  </span><br><span class="line">  </span><br><span class="line">plt.plot(df.index, df[<span class="string">&#x27;A&#x27;</span>],   </span><br><span class="line">        color=<span class="string">&#x27;#FFAA00&#x27;</span>,    <span class="comment"># 颜色  </span></span><br><span class="line">        linestyle=<span class="string">&#x27;--&#x27;</span>,     <span class="comment"># 线条样式  </span></span><br><span class="line">        linewidth=<span class="number">3</span>,        <span class="comment"># 线条宽度  </span></span><br><span class="line">        marker=<span class="string">&#x27;D&#x27;</span>)         <span class="comment"># 点标记  </span></span><br><span class="line">  </span><br><span class="line">plt.show()  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># seaborn其实是在matplotlib的基础上进行了更高级的API封装，从而使绘图更容易、更美观  </span></span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns  </span><br><span class="line"><span class="comment"># 绘制散点图  </span></span><br><span class="line">plt.scatter(df.index, df[<span class="string">&#x27;A&#x27;</span>])  </span><br><span class="line">plt.show()  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 美化plt  </span></span><br><span class="line">sns.set_style(<span class="string">&#x27;darkgrid&#x27;</span>)  </span><br><span class="line">plt.scatter(df.index, df[<span class="string">&#x27;A&#x27;</span>])  </span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="http://example.com">John Doe</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="http://example.com/2023/11/18/220%20-%20%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/223%20-%20Go%20&amp;%20Python/06%20-%20Python--%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7%E5%8C%85/">http://example.com/2023/11/18/220%20-%20%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/223%20-%20Go%20&amp;%20Python/06%20-%20Python--%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7%E5%8C%85/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/11/18/220%20-%20%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/222%20-%20C%20&amp;%20C++/%E9%87%8D%E5%AD%A6C++/" title=""><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Previous</div><div class="prev_info"></div></div></a></div><div class="next-post pull-right"><a href="/2023/11/18/220%20-%20%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/223%20-%20Go%20&amp;%20Python/07%20-%20Python%E7%A7%BB%E5%8A%A8%E7%AB%AF%E7%88%AC%E8%99%AB/" title=""><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Next</div><div class="next_info"></div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">John Doe</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">13</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">4</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-Pandas-%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86"><span class="toc-number">1.</span> <span class="toc-text">1 Pandas 数据处理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-Pandas-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-Series"><span class="toc-number">1.1.</span> <span class="toc-text">1.1 Pandas 数据结构 - Series</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-Pandas-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-DataFrame"><span class="toc-number">1.2.</span> <span class="toc-text">1.2 Pandas 数据结构 - DataFrame</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%85%A5"><span class="toc-number">1.3.</span> <span class="toc-text">1.3 数据导入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-4-%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86"><span class="toc-number">1.4.</span> <span class="toc-text">1.4 数据预处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-6-%E8%AE%A1%E7%AE%97%E6%93%8D%E4%BD%9C"><span class="toc-number">1.5.</span> <span class="toc-text">1.6 计算操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-6-1-%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="toc-number">1.5.1.</span> <span class="toc-text">1.6.1 基本操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-6-2-%E8%81%9A%E5%90%88%E8%AE%A1%E7%AE%97"><span class="toc-number">1.5.2.</span> <span class="toc-text">1.6.2 聚合计算</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-6-3-%E5%A4%9A%E8%A1%A8%E7%BB%84%E5%90%88"><span class="toc-number">1.5.3.</span> <span class="toc-text">1.6.3 多表组合</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-6-4-%E8%BE%93%E5%87%BA%E5%92%8C%E7%BB%98%E5%9B%BE"><span class="toc-number">1.5.4.</span> <span class="toc-text">1.6.4 输出和绘图</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/11/18/220%20-%20%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/00%20-%20%E7%9B%AE%E5%BD%95/" title="Untitled">Untitled</a><time datetime="2023-11-18T15:14:22.859Z" title="Created 2023-11-18 15:14:22">2023-11-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/11/18/255%20-%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD&amp;%E5%A4%A7%E6%95%B0%E6%8D%AE/01%20-%20%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0--%E5%9F%BA%E7%A1%80%E7%AF%87/" title="Untitled">Untitled</a><time datetime="2023-11-18T15:14:22.859Z" title="Created 2023-11-18 15:14:22">2023-11-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/11/18/200%20-%20%E6%88%91%E7%9A%84%E7%99%BE%E5%AE%9D%E7%AE%B1/204%20-%20%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/JetBrains%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/" title="Untitled">Untitled</a><time datetime="2023-11-18T15:14:22.859Z" title="Created 2023-11-18 15:14:22">2023-11-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/11/18/200%20-%20%E6%88%91%E7%9A%84%E7%99%BE%E5%AE%9D%E7%AE%B1/204%20-%20%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Obsidian%E7%9A%84%E4%BD%BF%E7%94%A8/" title="Untitled">Untitled</a><time datetime="2023-11-18T15:14:22.859Z" title="Created 2023-11-18 15:14:22">2023-11-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/11/18/220%20-%20%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/222%20-%20C%20&amp;%20C++/%E9%87%8D%E5%AD%A6C++/" title="Untitled">Untitled</a><time datetime="2023-11-18T15:14:22.859Z" title="Created 2023-11-18 15:14:22">2023-11-18</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By John Doe</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>